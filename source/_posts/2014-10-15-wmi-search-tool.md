---
layout: post
date: 2014-10-15 11:00:00
title: "PowerShell 技能连载 - WMI 搜索工具"
description: PowerTip of the Day - WMI Search Tool
categories:
- powershell
- tip
tags:
- powershell
- tip
- powertip
- series
---
_适用于 PowerShell 所有版本_

WMI 是一个很棒很强大的技术：只需要指定一个 WMI 类名，您就可以获取该类的所有实体。

    PS> Get-WmiObject -Class Win32_BIOS


    SMBIOSBIOSVersion : 76CN27WW
    Manufacturer      : LENOVO
    Name              : 76CN27WW
    SerialNumber      : 1006250300406
    Version           : LENOVO - 1



那么如何知道有哪些 WMI 类呢？以下是一个搜索工具函数：

    function Find-WMIClass
    {
       param
       (
          [Parameter(Mandatory=$true)]
          $SearchTerm = 'Resolution'
       )

       Get-WmiObject -Class * -List |
       Where-Object { $_.Properties.Count -ge 3 } |
       Where-Object { $_.Name -notlike 'Win32_Perf*'  } |
       Where-Object {
          $ListOfNames = $_.Properties | Select-Object -ExpandProperty Name
          ($ListOfNames -like "*$SearchTerm*") -ne $null
       } |
       Sort-Object -Property Name
    }

只需要指定一个搜索条件。该函数将会查找所有属性名中包含搜索条件的 WMI 类（可以用通配符来扩大搜索范围）。

这段代码能搜索属性以“resolution”结尾的 WMI 类：

    PS> Find-WMIClass -SearchTerm *resolution


       NameSpace: ROOT\cimv2

    Name                                Methods              Properties
    ----                                -------              ----------
    CIM_CacheMemory                     {SetPowerState, R... {Access, AdditionalErr...
    CIM_CurrentSensor                   {SetPowerState, R... {Accuracy, Availabilit...
    CIM_FlatPanel                       {SetPowerState, R... {Availability, Caption...
    CIM_Memory                          {SetPowerState, R... {Access, AdditionalErr...
    CIM_MonitorResolution               {}                   {Caption, Description,...
    CIM_NonVolatileStorage              {SetPowerState, R... {Access, AdditionalErr...
    CIM_NumericSensor                   {SetPowerState, R... {Accuracy, Availabilit...
    CIM_PCVideoController               {SetPowerState, R... {AcceleratorCapabiliti...
    CIM_PointingDevice                  {SetPowerState, R... {Availability, Caption...
    CIM_Printer                         {SetPowerState, R... {Availability, Availab...
    CIM_Tachometer                      {SetPowerState, R... {Accuracy, Availabilit...
    CIM_TemperatureSensor               {SetPowerState, R... {Accuracy, Availabilit...
    CIM_VideoController                 {SetPowerState, R... {AcceleratorCapabiliti...
    CIM_VideoControllerResolution       {}                   {Caption, Description,...
    CIM_VolatileStorage                 {SetPowerState, R... {Access, AdditionalErr...
    CIM_VoltageSensor                   {SetPowerState, R... {Accuracy, Availabilit...
    Win32_CacheMemory                   {SetPowerState, R... {Access, AdditionalErr...
    Win32_CurrentProbe                  {SetPowerState, R... {Accuracy, Availabilit...
    Win32_DisplayControllerConfigura... {}                   {BitsPerPixel, Caption...
    Win32_MemoryArray                   {SetPowerState, R... {Access, AdditionalErr...
    Win32_MemoryDevice                  {SetPowerState, R... {Access, AdditionalErr...
    Win32_NetworkAdapterConfiguration   {EnableDHCP, Rene... {ArpAlwaysSourceRoute,...
    Win32_PointingDevice                {SetPowerState, R... {Availability, Caption...
    Win32_Printer                       {SetPowerState, R... {Attributes, Availabil...
    Win32_PrinterConfiguration          {}                   {BitsPerPel, Caption, ...
    Win32_SMBIOSMemory                  {SetPowerState, R... {Access, AdditionalErr...
    Win32_TemperatureProbe              {SetPowerState, R... {Accuracy, Availabilit...
    Win32_VideoConfiguration            {}                   {ActualColorResolution...
    Win32_VideoController               {SetPowerState, R... {AcceleratorCapabiliti...
    Win32_VoltageProbe                  {SetPowerState, R... {Accuracy, Availabilit...

下一步，选择一个类名并观察它的实际数据：

    PS> Get-WmiObject -Class CIM_CacheMemory | Select-Object -Property *

<!--本文国际来源：[WMI Search Tool](http://community.idera.com/powershell/powertips/b/tips/posts/wmi-search-tool)-->
